<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">

<!-- Bootstrap Icons -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

<!-- TinyMCE script -->
<script
	src="https://cdn.tiny.cloud/1/q974vam9phu3qfp0bqotd2z9kqnvy45rfihy9w1kp0rjw4s0/tinymce/6/tinymce.min.js"
	referrerpolicy="origin"></script>


<!-- CSS -->
<link rel="stylesheet"
	th:href="@{/resources/css/EducatorConfig/TestConfiguration/QuestionManager.css}">
</head>

<body th:attr="data-assessment-id=${session.currentAssessmentId}">


<!-- Add this hidden input as a backup -->
<input type="hidden" id="hiddenAssessmentId" th:value="${session.currentAssessmentId}">


	<!-- Header - Start -->
	<div class="header d-flex align-items-center">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-6 d-flex align-items-center">
					<button class="btn btn-dashboard d-flex align-items-center me-3">
						<i class="bi bi-speedometer2 me-2"></i> <a
							th:href="@{/EducatorConfig/TestDashboard}"><span>Dashboard</span></a>
					</button>
					<h6 class="mb-0 fw-semibold">New test</h6>
				</div>
				<div class="col-md-6 text-end">
					<button
						class="btn btn-test-info d-flex align-items-center ms-auto me-3">
						<i class="bi bi-info-circle me-2"></i> <a
							th:href="@{/EducatorConfig/TestConfiguration/TestInfo}"><span
							class="text-muted">Test info</span></a>
					</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Header - End -->



	<!-- Full-Container - Start -->
	<div class="container-fluid">
		<div class="row g-0">
			<!-- Sidebar - Start-->
			<div class="col-md-3 col-lg-3 sidebar pt-3">
				<div class="ps-3 pe-3">
					<span class="setup-badge draft d-inline-block mb-3">SETUP IN
						PROGRESS</span>

					<!-- Test configuration - Start-->
					<div
						class="d-flex justify-content-between align-items-center sidebar-section-header">
						<h5 class="mb-0">Test configuration</h5>
						<i class="bi bi-chevron-up text-muted toggle-icon"></i>
					</div>

					<div class="progress-section mt-3 mb-3">
						<span>83% completed</span>
						<div class="progress-container flex-grow-1">
							<div class="progress-bar" style="width: 83%"></div>
						</div>
					</div>

					<!-- Test configuration Items - Start-->
					<div class="sidebar-navigation mt-4 collapsible-section">
						<a th:href="@{/EducatorConfig/TestConfiguration/BasicSettings}"
							class="sidebar-link"> <i class="bi bi-gear"></i> <span>Basic
								settings</span>
						</a> <a th:href="@{/EducatorConfig/TestConfiguration/QuestionManager}"
							class="sidebar-link active"> <i class="bi bi-list-check"></i>
							<span>Questions manager</span>
						</a> <a th:href="@{/EducatorConfig/TestConfiguration/TestSets}"
							class="sidebar-link"> <i class="bi bi-collection"></i> <span>Test
								sets</span>
						</a> <a th:href="@{/EducatorConfig/TestConfiguration/TestStartPage}"
							class="sidebar-link"> <i class="bi bi-file-text"></i> <span>Test
								start page</span>
						</a> <a th:href="@{/EducatorConfig/TestConfiguration/GradingSummary}"
							class="sidebar-link"> <i class="bi bi-trophy"></i> <span>Grading
								& summary</span>
						</a> <a th:href="@{/EducatorConfig/TestConfiguration/TimeSettings}"
							class="sidebar-link"> <i class="bi bi-clock"></i> <span>Time
								settings</span>
						</a>
					</div>
					<!-- Test configuration Items - End-->


                    <button class="btn btn-activate w-100 mt-3">
                        <i class="bi bi-play-fill"></i> Activate test
                    </button>


					<!-- Test configuration - End-->



					<div class="horizontal-divider mt-4"></div>

					<!-- Test progress & results - Start-->
					<div
						class="d-flex justify-content-between align-items-center mt-3 sidebar-section-header">
						<h5 class="mb-0">Test progress & results</h5>
						<i class="bi bi-chevron-down text-muted toggle-icon"></i>
					</div>

					<!-- Test progress & results Items - Start-->
					<div class="sidebar-navigation mt-3 collapsible-section collapsed">
						<a th:href="@{/EducatorConfig/TestResult/ResultTable}"
							class="sidebar-link"> <i class="bi bi-bar-chart"></i> <span>Results
								table</span>
						</a>

						<!-- <a href="#" class="sidebar-link">
        				<i class="bi bi-file-earmark-check"></i>
       					 <span>Test sheets review</span>
   						 </a> -->

						<a th:href="@{/EducatorConfig/TestResult/AssessmentReview}"
							class="sidebar-link"> <i class="bi bi-check-square"></i> <span>Answers
								review</span>
						</a>

						<!-- <a href="#" class="sidebar-link">
        				<i class="bi bi-graph-up"></i>
        				<span>Statistics</span>
    					</a> -->
					</div>
					<!-- Test progress & results Items - End-->


					<div class="horizontal-divider mt-4"></div>
					<!-- Test progress & results - End-->

				</div>
			</div>
			<!-- Sidebar - End-->




			<!-- Main Content - Start -->
			<div class="col-md-9 col-lg-9 main-content">
				<h5 class="mb-4" id="question-title">
					Question <span id="question-number">1</span>
				</h5>

				<!-- Main Content Items - Start -->
				<div class="card mb-4">
					<!-- Main Card - Start -->
					<div class="card-body p-4">

						<!-- Question-Tiny MCE - Start -->
						<div class="mb-4 tinymce-container">
							<textarea id="tinymce-editor">New test</textarea>
							<div id="char-count"
								class="char-count position-absolute end-0 top-0">8 / 100</div>
						</div>
						<!-- Question-Tiny MCE - End -->

						<!-- Answer-Type - Start -->
						<div class="mb-3">
							<div class="d-flex align-items-end flex-wrap">
								<div class="flex-grow-1 mb-3 mb-md-0">
									<label for="answer-type-select" class="form-label">Answer
										type</label> <select id="answer-type-select" class="form-select">
										<option value="single-choice">Single Choice (MCQ)</option>
										<option value="multiple-choice">Multiple Choice (MCQ)</option>
										<option value="true-false">True/False</option>
										<option value="short-answer">Short Answer</option>
										<option value="essay">Essay</option>
									</select>
								</div>
							</div>
						</div>
						<!-- Answer-Type - End -->

						<!-- Answers Section - Start -->
						<div class="answers-section mt-4 mb-4">
							<h6 class="answers-heading mb-3">Answers</h6>
							<p class="answers-instruction mb-3">After providing possible
								answers, select the correct one.</p>

							<!-- Single Choice Answers (Default) - Start -->
							<div id="single-choice-answers" class="answer-type-container">
								<!-- Answer Items will be here -->
								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="radio" name="correctAnswer"
														class="form-check-input mt-1" id="answer1">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container">
														<textarea class="tinymce-answer" id="single-answer-1">Answer option 1</textarea>
													</div>
												</div>
												<div class="answer-actions ms-2">
													<button class="btn btn-sm text-danger delete-answer">
														<i class="bi bi-trash"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="radio" name="correctAnswer"
														class="form-check-input mt-1" id="answer2">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container">
														<textarea class="tinymce-answer" id="single-answer-2">Answer option 2</textarea>
													</div>
												</div>
												<div class="answer-actions ms-2">
													<button class="btn btn-sm text-danger delete-answer">
														<i class="bi bi-trash"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!-- Add Answer Button -->
								<div class="add-answer-btn-container mt-3">
									<button class="btn add-answer-btn">
										<i class="bi bi-plus"></i> Add answer
									</button>
								</div>
							</div>
							<!-- Single Choice Answers - End -->

							<!-- Multiple Choice Answers - Start -->
							<div id="multiple-choice-answers" class="answer-type-container"
								style="display: none;">
								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="checkbox" class="form-check-input mt-1"
														id="multiAnswer1">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container">
														<textarea class="tinymce-answer" id="multi-answer-1">Answer option 1</textarea>
													</div>
												</div>
												<div class="answer-actions ms-2">
													<button class="btn btn-sm text-danger delete-answer">
														<i class="bi bi-trash"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="checkbox" class="form-check-input mt-1"
														id="multiAnswer2">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container">
														<textarea class="tinymce-answer" id="multi-answer-2">Answer option 2</textarea>
													</div>
												</div>
												<div class="answer-actions ms-2">
													<button class="btn btn-sm text-danger delete-answer">
														<i class="bi bi-trash"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!-- Add Answer Button -->
								<div class="add-answer-btn-container mt-3">
									<button class="btn add-answer-btn">
										<i class="bi bi-plus"></i> Add answer
									</button>
								</div>
							</div>
							<!-- Multiple Choice Answers - End -->

							<!-- True/False Answers - Start -->
							<div id="true-false-answers" class="answer-type-container"
								style="display: none;">
								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="radio" name="tfAnswer"
														class="form-check-input mt-1" id="answerTrue">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container tf-answer">
														<p class="mb-0">True</p>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="answer-item mb-3">
									<div class="card">
										<div class="card-body p-3">
											<div class="d-flex align-items-start">
												<div class="answer-selector me-2">
													<input type="radio" name="tfAnswer"
														class="form-check-input mt-1" id="answerFalse">
												</div>
												<div class="answer-content flex-grow-1">
													<div class="tinymce-answer-container tf-answer">
														<p class="mb-0">False</p>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<!-- True/False Answers - End -->

							<!-- Short Answer - Start -->
							<div id="short-answer" class="answer-type-container"
								style="display: none;">
								<div id="short-answer-items">
									<div class="answer-item mb-3">
										<div class="card">
											<div class="card-body p-3">
												<div class="answer-content">
													<div class="row gx-2 gy-2 align-items-center">
														<div class="col-md-8">
															<label class="form-label text-muted mb-2">Correct
																Answer</label> <input type="text"
																class="form-control short-answer-input"
																placeholder="Enter a correct answer">
														</div>
														<div class="col-md-3">
															<label class="form-label text-muted mb-2">Points</label>
															<input type="number"
																class="form-control short-answer-points" value="1"
																min="0">
														</div>
														<div class="col-md-1 d-flex align-items-end">
															<button
																class="btn btn-sm text-danger delete-short-answer mb-2">
																<i class="bi bi-trash"></i>
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!-- Add Answer Button -->
								<div class="add-answer-btn-container mt-3">
									<button class="btn add-short-answer-btn">
										<i class="bi bi-plus"></i> Add answer
									</button>
								</div>

								<!-- Short Answer Settings -->
								<div class="short-answer-settings mt-4">
									<div class="form-check form-switch mb-3">
										<input class="form-check-input" type="checkbox"
											id="manually-grade-toggle"> <label
											class="form-check-label" for="manually-grade-toggle">
											Manually grade this Question </label>
									</div>
								</div>
							</div>
							<!-- Short Answer - End -->

							<!-- Essay Answer - Start -->
							<div id="essay-answer" class="answer-type-container"
								style="display: none;">
								<div class="card">
									<div class="card-body p-3">
										<p class="mb-0 text-muted">Essay questions will be graded
											manually. Students will have a text area to enter their
											response.</p>
									</div>
								</div>
							</div>
							<!-- Essay Answer - End -->
						</div>
						<!-- Answers Section - End -->

						<!-- Question Mark Setting - Start -->
						<div class="mb-3 question-marks-field">
							<label for="question-marks" class="form-label">Question
								Marks</label> <input type="number" class="form-control"
								id="question-marks" value="1" min="0" style="max-width: 200px;">
						</div>
						<!-- Question Mark Setting - End -->

						<!-- Score Settings Section for Essay - Start -->
						<div id="essay-score-settings"
							class="score-settings-section mt-4 mb-4" style="display: none;">
							<h6 class="mb-3">Score settings</h6>

							<div class="card bg-light mb-3">
								<div class="card-body p-3">
									<div class="d-flex align-items-start">
										<div class="me-2">
											<i class="bi bi-info-circle"></i>
										</div>
										<div>
											<p class="mb-0">Define the maximum number of points for
												this essay question and set a word limit to guide students
												in their response length.</p>
										</div>
									</div>
								</div>
							</div>

							<div class="row gx-3 gy-3">
								<div class="col-md-6">
									<label class="form-label">Max. number of points</label> <input
										type="number" class="form-control" id="essay-max-points"
										value="10" min="0">
								</div>
								<div class="col-md-6">
									<label class="form-label">Max. number of words</label> <input
										type="number" class="form-control" id="essay-max-words"
										value="500" min="0"> <small
										class="text-muted d-block mt-1"> Set to 0 for no word
										limit. </small>
								</div>
							</div>
						</div>
						<!-- Score Settings Section - End -->


					</div>
					<!-- Main Card - End -->
				</div>

				<!-- Main Content Items - End -->

				<!-- Action Button - Start -->
				<div class="action-buttons">
					<button id="save-btn" class="btn btn-success me-2 mb-2 mb-md-0">Save</button>
					<button id="save-add-next-btn"
						class="btn btn-primary me-2 mb-2 mb-md-0">Save and add
						next</button>
					<button id="cancel-btn" class="btn btn-light mb-2 mb-md-0">Cancel</button>
				</div>
				<!-- Action Button - End -->

				<!-- Hidden Field for Question ID -->
				<input type="hidden" id="question-id" value="">
			</div>
			<!-- Main Content - End -->
		</div>
	</div>
	<!-- Full-Container - End -->

	<!-- Bootstrap JavaScript Bundle with Popper -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- JavaScript -->
	<script
		th:src="@{/resources/js/EducatorConfig/TestConfiguration/QuestionManager.js}"></script>


	<!-- Add this JavaScript to the beginning of your existing script to handle the question number -->
	<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get questionId from URL params
    const urlParams = new URLSearchParams(window.location.search);
    const questionId = urlParams.get('questionId');
    
    // Set up question title and numbering
    if (questionId) {
        document.getElementById('question-title').textContent = 'Edit Question';
        document.getElementById('question-id').value = questionId;
    } else {
        // Get current question count from sessionStorage or default to 1
        let questionCount = sessionStorage.getItem('questionCount') || '1';
        document.getElementById('question-number').textContent = questionCount;
    }
});
</script>
</body>

</html>